<?xml version="1.0"?>
<launch>
  <arg name="x" default="0"/>
  <arg name="y" default="0"/>
  <arg name="z" default="0"/>
  <arg name="R" default="0"/>
  <arg name="P" default="0"/>
  <arg name="Y" default="0"/>

  <arg name="start" default="-1.723340,-4.168233,1"/>
  <arg name="goal" default="3.230813,0.271203,1"/>

  <arg name="world" default="test_zone"/>
  <arg name="vehicle" default="iris"/>

  <arg name="octomap" default="$(find autopilot)/octomaps/$(arg world).bt"/>

  <!-- Launch ROS, MAVROS, PX4, Gazebo -->
  <include file="$(find px4)/launch/mavros_posix_sitl.launch">
    <arg name="x" default="$(arg x)"/>
    <arg name="y" default="$(arg y)"/>
    <arg name="z" default="$(arg z)"/>
    <arg name="R" default="$(arg R)"/>
    <arg name="P" default="$(arg P)"/>
    <arg name="Y" default="$(arg Y)"/>
    <arg name="vehicle" default="$(arg vehicle)"/>
    <arg name="world" default="$(find autopilot)/worlds/$(arg world).world"/>
    <arg name="sdf" default="$(find mavlink_sitl_gazebo)/models/$(arg vehicle)/$(arg vehicle).sdf"/>
  </include>

  <!-- Octomap server -->
	<node pkg="octomap_server" type="octomap_server_node" name="octomap_server" args="$(arg octomap)"></node>

  <!-- Rviz visualization tool -->
	<node pkg="rviz" type="rviz" name="rviz" args="-d $(find autopilot)/config.rviz"></node>

  <!-- Trajectory tracker -->  
  <node pkg="geometric_controller" type="geometric_controller_node" name="geometric_controller" output="screen">
    <param name="mav_name" type="string" value="$(arg vehicle)" />
    <remap from="command/bodyrate_command" to="/mavros/setpoint_raw/attitude"/>
    <param name="ctrl_mode" value="2" />
    <param name="enable_sim" value="true" />
  </node>

    <node pkg="autopilot" type="global_planner.py" name="global_planner" args="-p phi_star -l"></node>
</launch>
